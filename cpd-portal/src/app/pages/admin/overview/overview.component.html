<h2>Dashboard Overview</h2>
<p>Welcome to the admin control panel.</p>

<div class="dashboard-grid">

  <div class="dashboard-panel calendar-panel">
    <h3>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
      Calendar
    </h3>

    <div class="calendar-container">
      <div class="calendar-header">
        <button (click)="previousMonth()" class="calendar-nav-btn" aria-label="Previous month">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <div class="calendar-title">{{ currentMonth }} {{ currentYear }}</div>
        <button (click)="nextMonth()" class="calendar-nav-btn" aria-label="Next month">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>
      </div>

      <div class="calendar-weekdays">
        <div class="calendar-weekday">Sun</div>
        <div class="calendar-weekday">Mon</div>
        <div class="calendar-weekday">Tue</div>
        <div class="calendar-weekday">Wed</div>
        <div class="calendar-weekday">Thu</div>
        <div class="calendar-weekday">Fri</div>
        <div class="calendar-weekday">Sat</div>
      </div>

      <div class="calendar-days">
        <div *ngFor="let dayObj of calendarDays"
             class="calendar-day"
             [class.today]="dayObj.isToday"
             [class.other-month]="!dayObj.isCurrentMonth"
             [class.has-courses]="dayObj.courses && dayObj.courses.length > 0">
          <span *ngIf="dayObj.day" class="day-number">{{ dayObj.day }}</span>
          <div *ngIf="dayObj.courses && dayObj.courses.length > 0" class="course-indicators">
            <span class="course-dot" *ngFor="let course of dayObj.courses.slice(0, 3)"></span>
          </div>

          <!-- Tooltip on hover -->
          <div *ngIf="dayObj.courses && dayObj.courses.length > 0" class="calendar-tooltip">
            <div class="tooltip-header">
              {{ dayObj.courses.length }} {{ dayObj.courses.length === 1 ? 'Course' : 'Courses' }} Scheduled
            </div>
            <div class="tooltip-courses">
              <div *ngFor="let course of dayObj.courses" class="tooltip-course">
                <div class="tooltip-course-title">{{ course.title }}</div>
                <div class="tooltip-course-time">
                  {{ datePipe.transform(course.start_date, 'mediumDate') }} - {{ datePipe.transform(course.end_date, 'mediumDate') }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="dashboard-panel activity-log-panel">
    <h3>
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="12" y1="18" x2="12" y2="12"></line>
        <line x1="9" y1="15" x2="15" y2="15"></line>
      </svg>
      Recent Activity
    </h3>

    <div *ngIf="isLoadingLog" class="loading-state">
      <div class="spinner"></div>
      <span>Loading activity log...</span>
    </div>

    <div *ngIf="logLoadError" class="error-message">{{ logLoadError }}</div>

    <ul *ngIf="!isLoadingLog && !logLoadError && paginatedLogs.length > 0" class="activity-list">
      <li *ngFor="let entry of paginatedLogs">
        <div class="log-header">
          <span class="log-user">{{ entry.user_email || 'System' }}</span>
          <span class="log-timestamp">{{ datePipe.transform(entry.timestamp, 'short') }}</span>
        </div>
        <div class="log-body">
          <span class="log-action">{{ entry.action }}</span>
          <span *ngIf="entry.details" class="log-details">{{ entry.details }}</span>
        </div>
      </li>
    </ul>

    <p *ngIf="!isLoadingLog && !logLoadError && activityLog.length === 0" class="empty-state">No recent activity found.</p>

    <div *ngIf="!isLoadingLog && !logLoadError && totalPages > 1" class="pagination">
      <button (click)="previousPage()" [disabled]="currentPage === 1" class="pagination-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>

      <div class="pagination-info">
        Page {{ currentPage }} of {{ totalPages }}
      </div>

      <button (click)="nextPage()" [disabled]="currentPage === totalPages" class="pagination-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>

    <div class="panel-footer">
      <a routerLink="/admin/activity">View Full Log</a>
    </div>
  </div>

</div>